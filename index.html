<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Poker Bot AI - Advanced Interactive System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tensorflow/4.10.0/tf.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background: #0a0e1a; color: #e2e8f0; overflow-x: hidden; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(148, 163, 184, 0.1); }
        .card { width: 60px; height: 84px; background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%); border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-weight: bold; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.5), 0 2px 4px -1px rgba(0, 0, 0, 0.3); transition: all 0.3s ease; cursor: pointer; }
        .card:hover { transform: translateY(-8px) rotateY(10deg); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5); }
        .card.red { color: #dc2626; }
        .card.black { color: #1e293b; }
        .suit { font-size: 24px; line-height: 1; }
        .rank { font-size: 18px; line-height: 1; }
        .felt { background: radial-gradient(ellipse at center, #166534 0%, #14532d 50%, #0f3d22 100%); position: relative; overflow: hidden; }
        .felt::before { content: ''; position: absolute; inset: 0; background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); opacity: 0.5; }
        .glow { box-shadow: 0 0 20px rgba(59, 130, 246, 0.5); }
        .pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
        .slider { -webkit-appearance: none; width: 100%; height: 6px; border-radius: 5px; background: #334155; outline: none; cursor: pointer; }
        .slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 18px; height: 18px; border-radius: 50%; background: #3b82f6; cursor: pointer; transition: all 0.2s; }
        .slider::-webkit-slider-thumb:hover { transform: scale(1.2); background: #60a5fa; }
        .btn-action { transition: all 0.2s; position: relative; overflow: hidden; }
        .btn-action:hover { transform: translateY(-2px); box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.3); }
        .btn-action:active { transform: translateY(0); }
        .btn-action::after { content: ''; position: absolute; inset: 0; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.2), transparent); transform: translateX(-100%); transition: transform 0.5s; }
        .btn-action:hover::after { transform: translateX(100%); }
        .stat-card { transition: all 0.3s; cursor: pointer; }
        .stat-card:hover { transform: translateY(-5px); background: rgba(30, 41, 59, 0.8); border-color: rgba(59, 130, 246, 0.5); }
        .session-tab { transition: all 0.3s; cursor: pointer; }
        .session-tab.active { background: rgba(59, 130, 246, 0.2); border-color: #3b82f6; color: #60a5fa; }
        .neural-node { fill: #3b82f6; animation: neuralPulse 2s infinite; }
        @keyframes neuralPulse { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }
        .log-entry { border-left: 3px solid #3b82f6; padding-left: 12px; margin: 4px 0; font-size: 0.875rem; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        .player-seat { transition: all 0.3s; }
        .player-seat.active { transform: scale(1.1); z-index: 20; }
        .chip { width: 24px; height: 24px; border-radius: 50%; background: linear-gradient(135deg, #fbbf24 0%, #d97706 100%); border: 2px solid #92400e; box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: inline-flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; color: #78350f; }
        .progress-ring { transform: rotate(-90deg); }
        .progress-ring-circle { transition: stroke-dashoffset 0.35s; transform-origin: 50% 50%; }
        .heatmap-cell { transition: all 0.2s; cursor: pointer; }
        .heatmap-cell:hover { transform: scale(1.1); z-index: 10; }
        .range-slider { -webkit-appearance: none; width: 100%; height: 4px; border-radius: 2px; background: #1e293b; outline: none; }
        .range-slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 16px; height: 16px; border-radius: 50%; background: #10b981; cursor: pointer; }
        .decision-tree { font-size: 0.75rem; line-height: 1.4; }
        .decision-node { padding: 4px 8px; border-radius: 4px; margin: 2px; display: inline-block; }
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(4px); }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .tooltip { position: relative; }
        .tooltip:hover::after { content: attr(data-tip); position: absolute; bottom: 100%; left: 50%; transform: translateX(-50%); padding: 4px 8px; background: #1e293b; border: 1px solid #334155; border-radius: 4px; font-size: 0.75rem; white-space: nowrap; z-index: 50; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-blue-950 to-slate-900">

<!-- Header -->
<header class="glass fixed top-0 w-full z-50 border-b border-slate-700/50">
    <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center font-bold text-xl shadow-lg">‚ô†</div>
            <div>
                <h1 class="font-bold text-lg tracking-tight bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent">PokerBot AI Pro</h1>
                <p class="text-xs text-slate-400 mono">CFR + DQN + Real-time Adaptation</p>
            </div>
        </div>
        <div class="flex gap-4 text-sm items-center">
            <div class="flex items-center gap-2 px-3 py-1 rounded-full bg-slate-800/50 border border-slate-700">
                <div class="w-2 h-2 bg-green-500 rounded-full pulse"></div>
                <span class="text-slate-300 text-xs">Engine: <span class="mono text-green-400 font-bold">ONLINE</span></span>
            </div>
            <div class="flex items-center gap-2 px-3 py-1 rounded-full bg-slate-800/50 border border-slate-700">
                <div class="w-2 h-2 bg-purple-500 rounded-full"></div>
                <span class="text-slate-300 text-xs">Mode: <span id="current-mode" class="mono text-purple-400 font-bold">GTO</span></span>
            </div>
            <button onclick="toggleAutoPlay()" id="auto-play-btn" class="px-4 py-1.5 bg-gradient-to-r from-orange-600 to-red-600 rounded-lg text-xs font-bold hover:from-orange-500 hover:to-red-500 transition btn-action">
                ü§ñ Auto-Play: OFF
            </button>
        </div>
    </div>
</header>

<!-- Session Tabs -->
<div class="pt-20 pb-4 px-4 max-w-7xl mx-auto">
    <div class="flex gap-2 overflow-x-auto pb-2">
        <button onclick="switchSession('game')" id="tab-game" class="session-tab active px-6 py-3 rounded-lg border border-slate-700 bg-slate-800/50 text-sm font-semibold flex items-center gap-2">
            <span>üéÆ</span> Game Arena
        </button>
        <button onclick="switchSession('training')" id="tab-training" class="session-tab px-6 py-3 rounded-lg border border-slate-700 bg-slate-800/50 text-sm font-semibold flex items-center gap-2 text-slate-400">
            <span>üß†</span> AI Training Center
        </button>
        <button onclick="switchSession('analytics')" id="tab-analytics" class="session-tab px-6 py-3 rounded-lg border border-slate-700 bg-slate-800/50 text-sm font-semibold flex items-center gap-2 text-slate-400">
            <span>üìä</span> Analytics Lab
        </button>
        <button onclick="switchSession('strategy')" id="tab-strategy" class="session-tab px-6 py-3 rounded-lg border border-slate-700 bg-slate-800/50 text-sm font-semibold flex items-center gap-2 text-slate-400">
            <span>üéØ</span> Strategy Explorer
        </button>
        <button onclick="switchSession('neural')" id="tab-neural" class="session-tab px-6 py-3 rounded-lg border border-slate-700 bg-slate-800/50 text-sm font-semibold flex items-center gap-2 text-slate-400">
            <span>‚ö°</span> Neural Visualizer
        </button>
    </div>
</div>

<!-- Main Content -->
<main class="px-4 max-w-7xl mx-auto pb-8">

    <!-- GAME ARENA SESSION -->
    <div id="session-game" class="session-content">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- Left Panel: Game Controls -->
            <div class="lg:col-span-3 space-y-4">
                <div class="glass rounded-xl p-5 border border-slate-700/50">
                    <h2 class="text-lg font-bold mb-4 flex items-center gap-2 text-blue-400">
                        <span>üé≤</span> Game Control
                    </h2>
                    
                    <div class="space-y-3">
                        <button onclick="game.newHand()" class="w-full py-3 bg-gradient-to-r from-blue-600 to-blue-500 rounded-lg font-bold text-white shadow-lg btn-action flex items-center justify-center gap-2 group">
                            <span class="group-hover:animate-spin">üé≤</span> New Hand
                        </button>
                        
                        <button onclick="game.simulateHand()" class="w-full py-3 bg-gradient-to-r from-purple-600 to-purple-500 rounded-lg font-bold text-white shadow-lg btn-action flex items-center justify-center gap-2">
                            <span>‚ö°</span> Simulate vs AI
                        </button>
                        
                        <button onclick="game.autoPlayHands(10)" class="w-full py-3 bg-gradient-to-r from-green-600 to-green-500 rounded-lg font-bold text-white shadow-lg btn-action flex items-center justify-center gap-2">
                            <span>‚ñ∂</span> Burst Mode (10x)
                        </button>
                        
                        <button onclick="toggleSpeedMode()" id="speed-btn" class="w-full py-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-bold text-white shadow-lg btn-action flex items-center justify-center gap-2">
                            <span>üöÄ</span> Speed: Normal
                        </button>
                    </div>

                    <div class="mt-6 pt-6 border-t border-slate-700">
                        <label class="text-xs text-slate-400 uppercase font-bold tracking-wider mb-3 block">Bot Intelligence</label>
                        
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between text-xs mb-2">
                                    <span class="text-slate-400">CFR Weight</span>
                                    <span id="cfr-weight-val" class="text-blue-400 font-bold">70%</span>
                                </div>
                                <input type="range" min="0" max="100" value="70" class="slider" id="cfr-weight" oninput="updateStrategyMix('cfr', this.value)">
                            </div>
                            
                            <div>
                                <div class="flex justify-between text-xs mb-2">
                                    <span class="text-slate-400">DQN Weight</span>
                                    <span id="dqn-weight-val" class="text-purple-400 font-bold">30%</span>
                                </div>
                                <input type="range" min="0" max="100" value="30" class="slider" id="dqn-weight" oninput="updateStrategyMix('dqn', this.value)">
                            </div>
                            
                            <div>
                                <div class="flex justify-between text-xs mb-2">
                                    <span class="text-slate-400">Aggression</span>
                                    <span id="aggro-val" class="text-orange-400 font-bold">50%</span>
                                </div>
                                <input type="range" min="0" max="100" value="50" class="slider" id="aggression" oninput="bot.setAggression(this.value)">
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 p-3 bg-slate-800/50 rounded-lg border border-slate-700">
                        <div class="text-xs text-slate-400 mb-2">Current Strategy Blend</div>
                        <div class="flex items-center gap-2">
                            <div class="flex-1 h-2 bg-slate-700 rounded-full overflow-hidden">
                                <div id="strategy-bar" class="h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-500" style="width: 100%"></div>
                            </div>
                        </div>
                        <div class="flex justify-between text-xs mt-1">
                            <span class="text-blue-400">GTO</span>
                            <span class="text-purple-400">Neural</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="glass rounded-xl p-5 border border-slate-700/50">
                    <h3 class="text-sm font-bold mb-3 text-slate-300">Session Stats</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="stat-card p-3 bg-slate-800/30 rounded-lg border border-slate-700/50" onclick="showStatDetail('hands')">
                            <div class="text-2xl font-bold text-white" id="stat-hands">0</div>
                            <div class="text-xs text-slate-400">Hands Played</div>
                        </div>
                        <div class="stat-card p-3 bg-slate-800/30 rounded-lg border border-slate-700/50" onclick="showStatDetail('winrate')">
                            <div class="text-2xl font-bold text-green-400" id="stat-winrate">0%</div>
                            <div class="text-xs text-slate-400">Win Rate</div>
                        </div>
                        <div class="stat-card p-3 bg-slate-800/30 rounded-lg border border-slate-700/50" onclick="showStatDetail('profit')">
                            <div class="text-2xl font-bold text-blue-400" id="stat-profit">$0</div>
                            <div class="text-xs text-slate-400">Net Profit</div>
                        </div>
                        <div class="stat-card p-3 bg-slate-800/30 rounded-lg border border-slate-700/50" onclick="showStatDetail('bb')">
                            <div class="text-2xl font-bold text-purple-400" id="stat-bb">0</div>
                            <div class="text-xs text-slate-400">BB/100</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Center: Poker Table -->
            <div class="lg:col-span-6">
                <div class="felt rounded-2xl p-6 relative min-h-[600px] border-4 border-slate-800 shadow-2xl overflow-hidden">
                    <!-- Table texture overlay -->
                    <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg width=\'100\' height=\'100\' viewBox=\'0 0 100 100\' xmlns=\'http://www.w3.org/2000/svg\'%3E%3Cpath d=\'M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z\' fill=\'%23ffffff\' fill-opacity=\'0.05\' fill-rule=\'evenodd\'/%3E%3C/svg%3E')] opacity-30"></div>
                    
                    <!-- Pot Display -->
                    <div class="absolute top-8 left-1/2 transform -translate-x-1/2 z-20">
                        <div class="flex flex-col items-center">
                            <div class="flex items-center gap-2 mb-2">
                                <div class="chip">$</div>
                                <div class="chip">$</div>
                                <div class="chip">$</div>
                            </div>
                            <div class="px-6 py-2 bg-black/60 backdrop-blur-md rounded-full border border-yellow-500/30 shadow-xl">
                                <span class="text-yellow-400 font-bold text-2xl mono" id="pot-display">$0</span>
                            </div>
                            <div class="text-xs text-slate-400 mt-1">Main Pot</div>
                        </div>
                    </div>

                    <!-- Community Cards -->
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10">
                        <div class="flex gap-3 mb-4" id="community-cards">
                            <div class="w-16 h-24 bg-slate-800/80 rounded-xl border-2 border-slate-600 border-dashed flex items-center justify-center text-slate-600 text-3xl backdrop-blur-sm">?</div>
                            <div class="w-16 h-24 bg-slate-800/80 rounded-xl border-2 border-slate-600 border-dashed flex items-center justify-center text-slate-600 text-3xl backdrop-blur-sm">?</div>
                            <div class="w-16 h-24 bg-slate-800/80 rounded-xl border-2 border-slate-600 border-dashed flex items-center justify-center text-slate-600 text-3xl backdrop-blur-sm">?</div>
                            <div class="w-16 h-24 bg-slate-800/80 rounded-xl border-2 border-slate-600 border-dashed flex items-center justify-center text-slate-600 text-3xl backdrop-blur-sm">?</div>
                            <div class="w-16 h-24 bg-slate-800/80 rounded-xl border-2 border-slate-600 border-dashed flex items-center justify-center text-slate-600 text-3xl backdrop-blur-sm">?</div>
                        </div>
                        
                        <!-- Street Indicator -->
                        <div class="text-center">
                            <span id="street-indicator" class="px-4 py-1 bg-slate-800/80 rounded-full text-xs font-bold text-slate-400 border border-slate-700">Waiting for deal...</span>
                        </div>
                    </div>

                    <!-- Players Container -->
                    <div id="players-container" class="absolute inset-0 z-10">
                        <!-- Players positioned by JS -->
                    </div>

                    <!-- Action Buttons (Human Turn) -->
                    <div id="action-panel" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 z-30 hidden">
                        <div class="glass rounded-2xl p-4 border border-slate-600/50 shadow-2xl">
                            <div class="flex items-center gap-3 mb-3">
                                <div class="text-xs text-slate-400">Facing bet:</div>
                                <div class="text-lg font-bold text-white mono" id="facing-bet">$0</div>
                                <div class="text-xs text-slate-400 ml-4">Your equity:</div>
                                <div class="text-lg font-bold text-green-400 mono" id="hand-equity">--%</div>
                            </div>
                            
                            <div class="flex gap-2">
                                <button onclick="game.playerAction('fold')" class="px-6 py-3 bg-gradient-to-r from-red-700 to-red-600 hover:from-red-600 hover:to-red-500 rounded-xl font-bold text-white shadow-lg btn-action min-w-[80px]">
                                    FOLD
                                </button>
                                <button onclick="game.playerAction('check')" id="btn-check" class="px-6 py-3 bg-gradient-to-r from-slate-600 to-slate-500 hover:from-slate-500 hover:to-slate-400 rounded-xl font-bold text-white shadow-lg btn-action min-w-[80px]">
                                    CHECK
                                </button>
                                <button onclick="game.playerAction('call')" id="btn-call" class="px-6 py-3 bg-gradient-to-r from-blue-700 to-blue-600 hover:from-blue-600 hover:to-blue-500 rounded-xl font-bold text-white shadow-lg btn-action min-w-[80px]">
                                    CALL <span id="call-amount" class="text-sm block">$0</span>
                                </button>
                                <div class="relative">
                                    <button onclick="game.playerAction('raise')" class="px-6 py-3 bg-gradient-to-r from-green-700 to-green-600 hover:from-green-600 hover:to-green-500 rounded-xl font-bold text-white shadow-lg btn-action min-w-[100px]">
                                        RAISE
                                    </button>
                                    <div class="absolute -top-12 left-0 right-0">
                                        <input type="range" min="1" max="100" value="50" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer" id="raise-slider" oninput="updateRaiseDisplay(this.value)">
                                        <div class="text-center text-xs text-green-400 mt-1 font-bold" id="raise-display">1.5x Pot</div>
                                    </div>
                                </div>
                                <button onclick="game.playerAction('allin')" class="px-6 py-3 bg-gradient-to-r from-orange-700 to-orange-600 hover:from-orange-600 hover:to-orange-500 rounded-xl font-bold text-white shadow-lg btn-action min-w-[80px]">
                                    ALL-IN
                                </button>
                            </div>
                            
                            <div class="mt-3 text-xs text-center text-slate-400" id="ai-suggestion">
                                AI Suggestion: Waiting for analysis...
                            </div>
                        </div>
                    </div>

                    <!-- AI Thinking Indicator -->
                    <div id="ai-thinking" class="absolute bottom-6 left-1/2 transform -translate-x-1/2 z-30 hidden">
                        <div class="glass rounded-full px-6 py-3 border border-purple-500/30 flex items-center gap-3">
                            <div class="flex gap-1">
                                <div class="w-2 h-2 bg-purple-400 rounded-full animate-bounce" style="animation-delay: 0s"></div>
                                <div class="w-2 h-2 bg-purple-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                                <div class="w-2 h-2 bg-purple-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                            </div>
                            <span class="text-sm font-bold text-purple-400">AI Calculating...</span>
                        </div>
                    </div>
                </div>

                <!-- Game Log -->
                <div class="mt-4 glass rounded-xl p-4 border border-slate-700/50 h-48 overflow-hidden flex flex-col">
                    <div class="flex justify-between items-center mb-3">
                        <h3 class="font-bold text-sm text-slate-300 flex items-center gap-2">
                            <span class="text-blue-400">üìù</span> Hand History
                        </h3>
                        <button onclick="clearLog()" class="text-xs text-slate-500 hover:text-slate-300">Clear</button>
                    </div>
                    <div id="game-log" class="flex-1 overflow-y-auto space-y-2 text-sm mono pr-2">
                        <div class="text-slate-500 italic">System initialized. Click "New Hand" to begin...</div>
                    </div>
                </div>
            </div>

            <!-- Right Panel: Live Intelligence -->
            <div class="lg:col-span-3 space-y-4">
                <!-- AI Decision Panel -->
                <div class="glass rounded-xl p-5 border border-slate-700/50">
                    <h3 class="text-sm font-bold mb-3 text-purple-400 flex items-center gap-2">
                        <span>üß†</span> AI Decision Process
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="p-3 bg-slate-800/50 rounded-lg border border-slate-700">
                            <div class="flex justify-between text-xs mb-1">
                                <span class="text-slate-400">Hand Equity</span>
                                <span id="ai-equity" class="text-green-400 font-bold">--%</span>
                            </div>
                            <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
                                <div id="ai-equity-bar" class="h-full bg-green-500 transition-all duration-500" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="p-3 bg-slate-800/50 rounded-lg border border-slate-700">
                            <div class="flex justify-between text-xs mb-1">
                                <span class="text-slate-400">Pot Odds</span>
                                <span id="ai-odds" class="text-blue-400 font-bold">--%</span>
                            </div>
                            <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
                                <div id="ai-odds-bar" class="h-full bg-blue-500 transition-all duration-500" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="p-3 bg-slate-800/50 rounded-lg border border-slate-700">
                            <div class="text-xs text-slate-400 mb-2">Strategy Blend</div>
                            <div class="flex items-center gap-2">
                                <div class="flex-1 h-8 bg-slate-700 rounded-lg overflow-hidden flex">
                                    <div id="gto-portion" class="h-full bg-blue-500 flex items-center justify-center text-xs font-bold text-white transition-all" style="width: 70%">GTO</div>
                                    <div id="exp-portion" class="h-full bg-purple-500 flex items-center justify-center text-xs font-bold text-white transition-all" style="width: 30%">EXP</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="p-3 bg-slate-800/50 rounded-lg border border-slate-700">
                            <div class="text-xs text-slate-400 mb-2">Action Probabilities</div>
                            <div class="space-y-1" id="action-probs">
                                <div class="flex justify-between text-xs"><span class="text-slate-500">Fold</span><span class="text-slate-300">--%</span></div>
                                <div class="flex justify-between text-xs"><span class="text-slate-500">Check</span><span class="text-slate-300">--%</span></div>
                                <div class="flex justify-between text-xs"><span class="text-slate-500">Call</span><span class="text-slate-300">--%</span></div>
                                <div class="flex justify-between text-xs"><span class="text-slate-500">Raise</span><span class="text-slate-300">--%</span></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3 p-3 bg-gradient-to-r from-blue-900/30 to-purple-900/30 rounded-lg border border-blue-500/20">
                        <div class="text-xs text-blue-400 font-bold mb-1">AI Reasoning:</div>
                        <div class="text-xs text-slate-300" id="ai-reasoning">Waiting for hand to start...</div>
                    </div>
                </div>

                <!-- Opponent Models -->
                <div class="glass rounded-xl p-5 border border-slate-700/50">
                    <h3 class="text-sm font-bold mb-3 text-orange-400 flex items-center gap-2">
                        <span>üë•</span> Opponent Intel
                    </h3>
                    <div id="opponent-panel" class="space-y-2 max-h-48 overflow-y-auto">
                        <div class="text-slate-500 italic text-xs">No opponents profiled yet...</div>
                    </div>
                </div>

                <!-- Live EV Chart -->
                <div class="glass rounded-xl p-5 border border-slate-700/50">
                    <h3 class="text-sm font-bold mb-3 text-green-400 flex items-center gap-2">
                        <span>üìà</span> Expected Value
                    </h3>
                    <canvas id="evChart" height="120"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- TRAINING CENTER SESSION -->
    <div id="session-training" class="session-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- CFR Training -->
            <div class="glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-blue-400 flex items-center gap-2">
                    <span>üßÆ</span> CFR Blueprint Training
                </h2>
                <p class="text-sm text-slate-400 mb-4">Train Game Theory Optimal strategy using Counterfactual Regret Minimization</p>
                
                <div class="space-y-4">
                    <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700">
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-sm font-bold">Training Progress</span>
                            <span id="cfr-progress" class="text-xs text-blue-400 mono">0/100000 iterations</span>
                        </div>
                        <div class="h-3 bg-slate-700 rounded-full overflow-hidden">
                            <div id="cfr-progress-bar" class="h-full bg-gradient-to-r from-blue-600 to-blue-400 transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-3 bg-slate-800/30 rounded-lg">
                            <div class="text-xs text-slate-400">Nodes Created</div>
                            <div id="cfr-nodes" class="text-2xl font-bold text-white mono">0</div>
                        </div>
                        <div class="p-3 bg-slate-800/30 rounded-lg">
                            <div class="text-xs text-slate-400">Avg Regret</div>
                            <div id="cfr-regret" class="text-2xl font-bold text-blue-400 mono">0.000</div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="startCFRTraining(10000)" class="flex-1 py-3 bg-blue-600 hover:bg-blue-500 rounded-lg font-bold btn-action">
                            Train 10K
                        </button>
                        <button onclick="startCFRTraining(50000)" class="flex-1 py-3 bg-blue-700 hover:bg-blue-600 rounded-lg font-bold btn-action">
                            Train 50K
                        </button>
                        <button onclick="stopCFRTraining()" class="px-4 py-3 bg-red-600 hover:bg-red-500 rounded-lg font-bold btn-action">
                            Stop
                        </button>
                    </div>
                    
                    <div class="p-3 bg-slate-800/30 rounded-lg border border-slate-700">
                        <div class="text-xs text-slate-400 mb-2">Convergence Graph</div>
                        <canvas id="cfrChart" height="100"></canvas>
                    </div>
                </div>
            </div>

            <!-- DQN Training -->
            <div class="glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-purple-400 flex items-center gap-2">
                    <span>ü§ñ</span> Neural Network Training
                </h2>
                <p class="text-sm text-slate-400 mb-4">Train Deep Q-Network through self-play reinforcement learning</p>
                
                <div class="space-y-4">
                    <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700">
                        <div class="flex justify-between items-center mb-3">
                            <span class="text-sm font-bold">Episode Progress</span>
                            <span id="dqn-progress" class="text-xs text-purple-400 mono">0/1000 episodes</span>
                        </div>
                        <div class="h-3 bg-slate-700 rounded-full overflow-hidden">
                            <div id="dqn-progress-bar" class="h-full bg-gradient-to-r from-purple-600 to-purple-400 transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-3 gap-3">
                        <div class="p-3 bg-slate-800/30 rounded-lg">
                            <div class="text-xs text-slate-400">Epsilon</div>
                            <div id="dqn-epsilon" class="text-xl font-bold text-purple-400 mono">1.00</div>
                        </div>
                        <div class="p-3 bg-slate-800/30 rounded-lg">
                            <div class="text-xs text-slate-400">Loss</div>
                            <div id="dqn-loss" class="text-xl font-bold text-red-400 mono">--</div>
                        </div>
                        <div class="p-3 bg-slate-800/30 rounded-lg">
                            <div class="text-xs text-slate-400">Avg Reward</div>
                            <div id="dqn-reward" class="text-xl font-bold text-green-400 mono">0</div>
                        </div>
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="startDQNTraining(100)" class="flex-1 py-3 bg-purple-600 hover:bg-purple-500 rounded-lg font-bold btn-action">
                            100 Episodes
                        </button>
                        <button onclick="startDQNTraining(500)" class="flex-1 py-3 bg-purple-700 hover:bg-purple-600 rounded-lg font-bold btn-action">
                            500 Episodes
                        </button>
                        <button onclick="stopDQNTraining()" class="px-4 py-3 bg-red-600 hover:bg-red-500 rounded-lg font-bold btn-action">
                            Stop
                        </button>
                    </div>
                    
                    <div class="p-3 bg-slate-800/30 rounded-lg border border-slate-700">
                        <div class="text-xs text-slate-400 mb-2">Training Loss</div>
                        <canvas id="dqnChart" height="100"></canvas>
                    </div>
                </div>
            </div>

            <!-- Advanced Settings -->
            <div class="lg:col-span-2 glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-orange-400 flex items-center gap-2">
                    <span>‚öôÔ∏è</span> Advanced Training Parameters
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <label class="text-xs text-slate-400 uppercase font-bold mb-2 block">Learning Rate</label>
                        <input type="range" min="1" max="100" value="10" class="slider mb-2" id="lr-slider" oninput="updateParam('lr', this.value)">
                        <div class="text-center text-sm font-bold text-orange-400" id="lr-display">0.001</div>
                    </div>
                    
                    <div>
                        <label class="text-xs text-slate-400 uppercase font-bold mb-2 block">Discount Factor (Œ≥)</label>
                        <input type="range" min="80" max="99" value="95" class="slider mb-2" id="gamma-slider" oninput="updateParam('gamma', this.value)">
                        <div class="text-center text-sm font-bold text-orange-400" id="gamma-display">0.95</div>
                    </div>
                    
                    <div>
                        <label class="text-xs text-slate-400 uppercase font-bold mb-2 block">Batch Size</label>
                        <input type="range" min="16" max="128" value="32" class="slider mb-2" id="batch-slider" oninput="updateParam('batch', this.value)">
                        <div class="text-center text-sm font-bold text-orange-400" id="batch-display">32</div>
                    </div>
                </div>
                
                <div class="mt-6 p-4 bg-gradient-to-r from-orange-900/20 to-red-900/20 rounded-lg border border-orange-500/20">
                    <div class="flex items-start gap-3">
                        <span class="text-2xl">‚ö†Ô∏è</span>
                        <div>
                            <div class="font-bold text-orange-400 text-sm mb-1">Training Warning</div>
                            <div class="text-xs text-slate-400">Training large networks may cause browser slowdown. Recommended: Train in batches of 10K iterations and save progress frequently.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ANALYTICS LAB SESSION -->
    <div id="session-analytics" class="session-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Performance Metrics -->
            <div class="lg:col-span-2 glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-green-400 flex items-center gap-2">
                    <span>üìä</span> Performance Analytics
                </h2>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700 text-center">
                        <div class="text-3xl font-bold text-white mb-1" id="total-hands">0</div>
                        <div class="text-xs text-slate-400">Total Hands</div>
                    </div>
                    <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700 text-center">
                        <div class="text-3xl font-bold text-green-400 mb-1" id="total-profit">$0</div>
                        <div class="text-xs text-slate-400">Total Profit</div>
                    </div>
                    <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700 text-center">
                        <div class="text-3xl font-bold text-blue-400 mb-1" id="avg-bb">0</div>
                        <div class="text-xs text-slate-400">BB/100</div>
                    </div>
                    <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700 text-center">
                        <div class="text-3xl font-bold text-purple-400 mb-1" id="peak-profit">$0</div>
                        <div class="text-xs text-slate-400">Peak Profit</div>
                    </div>
                </div>
                
                <div class="p-4 bg-slate-800/30 rounded-lg border border-slate-700">
                    <canvas id="profitChart" height="200"></canvas>
                </div>
            </div>

            <!-- Hand Distribution -->
            <div class="glass rounded-xl p-6 border border-slate-700/50">
                <h3 class="text-lg font-bold mb-4 text-blue-400">Starting Hand Performance</h3>
                <div class="space-y-2 max-h-96 overflow-y-auto" id="hand-distribution">
                    <div class="text-slate-500 italic text-sm">Play hands to see statistics...</div>
                </div>
            </div>

            <!-- Position Analysis -->
            <div class="lg:col-span-2 glass rounded-xl p-6 border border-slate-700/50">
                <h3 class="text-lg font-bold mb-4 text-purple-400">Positional Performance</h3>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-3">
                    <div class="p-3 bg-slate-800/50 rounded-lg text-center border border-slate-700">
                        <div class="text-xs text-slate-400 mb-1">SB</div>
                        <div class="text-lg font-bold text-white" id="pos-sb">0 BB</div>
                    </div>
                    <div class="p-3 bg-slate-800/50 rounded-lg text-center border border-slate-700">
                        <div class="text-xs text-slate-400 mb-1">BB</div>
                        <div class="text-lg font-bold text-white" id="pos-bb">0 BB</div>
                    </div>
                    <div class="p-3 bg-slate-800/50 rounded-lg text-center border border-slate-700">
                        <div class="text-xs text-slate-400 mb-1">UTG</div>
                        <div class="text-lg font-bold text-white" id="pos-utg">0 BB</div>
                    </div>
                    <div class="p-3 bg-slate-800/50 rounded-lg text-center border border-slate-700">
                        <div class="text-xs text-slate-400 mb-1">MP</div>
                        <div class="text-lg font-bold text-white" id="pos-mp">0 BB</div>
                    </div>
                    <div class="p-3 bg-slate-800/50 rounded-lg text-center border border-slate-700">
                        <div class="text-xs text-slate-400 mb-1">CO</div>
                        <div class="text-lg font-bold text-white" id="pos-co">0 BB</div>
                    </div>
                    <div class="p-3 bg-slate-800/50 rounded-lg text-center border border-slate-700 ring-2 ring-green-500/50">
                        <div class="text-xs text-green-400 mb-1">BTN</div>
                        <div class="text-lg font-bold text-green-400" id="pos-btn">0 BB</div>
                    </div>
                </div>
            </div>

            <!-- Showdown Stats -->
            <div class="glass rounded-xl p-6 border border-slate-700/50">
                <h3 class="text-lg font-bold mb-4 text-orange-400">Showdown Analysis</h3>
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-slate-800/30 rounded-lg">
                        <span class="text-sm text-slate-400">Went to Showdown</span>
                        <span id="stat-wtsd" class="font-bold text-white">0%</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-slate-800/30 rounded-lg">
                        <span class="text-sm text-slate-400">Won at Showdown</span>
                        <span id="stat-wsd" class="font-bold text-green-400">0%</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-slate-800/30 rounded-lg">
                        <span class="text-sm text-slate-400">Won Without Showdown</span>
                        <span id="stat-wwosd" class="font-bold text-blue-400">0%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- STRATEGY EXPLORER SESSION -->
    <div id="session-strategy" class="session-content hidden">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Preflop Ranges -->
            <div class="glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-blue-400">Preflop Range Visualizer</h2>
                
                <div class="flex gap-2 mb-4">
                    <button onclick="showRange('ep')" class="px-3 py-1 bg-blue-600 rounded text-xs font-bold">Early</button>
                    <button onclick="showRange('mp')" class="px-3 py-1 bg-slate-700 rounded text-xs font-bold">Mid</button>
                    <button onclick="showRange('co')" class="px-3 py-1 bg-slate-700 rounded text-xs font-bold">CO</button>
                    <button onclick="showRange('btn')" class="px-3 py-1 bg-slate-700 rounded text-xs font-bold">BTN</button>
                    <button onclick="showRange('bb')" class="px-3 py-1 bg-slate-700 rounded text-xs font-bold">BB</button>
                </div>
                
                <div id="range-grid" class="grid grid-cols-13 gap-1 aspect-square max-w-md mx-auto">
                    <!-- Generated by JS -->
                </div>
                
                <div class="mt-4 flex gap-4 justify-center text-xs">
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-red-500 rounded"></div> Raise</div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-blue-500 rounded"></div> Call</div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 bg-slate-700 rounded"></div> Fold</div>
                </div>
            </div>

            <!-- Decision Tree -->
            <div class="glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-purple-400">Decision Tree Explorer</h2>
                
                <div class="p-4 bg-slate-800/50 rounded-lg border border-slate-700 h-96 overflow-y-auto decision-tree" id="decision-tree">
                    <div class="text-slate-500 italic">Load a hand to see decision tree...</div>
                </div>
            </div>

            <!-- GTO vs Exploitative -->
            <div class="lg:col-span-2 glass rounded-xl p-6 border border-slate-700/50">
                <h2 class="text-xl font-bold mb-4 text-orange-400">Strategy Comparison: GTO vs Exploitative</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="p-4 bg-blue-900/20 rounded-lg border border-blue-500/30">
                        <h3 class="font-bold text-blue-400 mb-3">GTO (Game Theory Optimal)</h3>
                        <ul class="text-sm text-slate-300 space-y-2">
                            <li>‚úì Unexploitable by definition</li>
                            <li>‚úì Balanced ranges prevent tells</li>
                            <li>‚úì Optimal vs strong opponents</li>
                            <li>‚úó Misses profit from weak players</li>
                            <li>‚úó Complex to implement perfectly</li>
                        </ul>
                        <div class="mt-3 text-xs text-blue-400 font-bold">Best for: Unknown opponents, high stakes</div>
                    </div>
                    
                    <div class="p-4 bg-purple-900/20 rounded-lg border border-purple-500/30">
                        <h3 class="font-bold text-purple-400 mb-3">Exploitative</h3>
                        <ul class="text-sm text-slate-300 space-y-2">
                            <li>‚úì Maximizes profit vs weak players</li>
                            <li>‚úì Adapts to specific tendencies</li>
                            <li>‚úì Simpler to execute</li>
                            <li>‚úó Can be counter-exploited</li>
                            <li>‚úó Requires accurate reads</li>
                        </ul>
                        <div class="mt-3 text-xs text-purple-400 font-bold">Best for: Known opponents, soft games</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- NEURAL VISUALIZER SESSION -->
    <div id="session-neural" class="session-content hidden">
        <div class="glass rounded-xl p-6 border border-slate-700/50 mb-6">
            <h2 class="text-xl font-bold mb-4 text-cyan-400 flex items-center gap-2">
                <span>üß¨</span> Neural Network Architecture
            </h2>
            
            <div class="relative h-96 bg-slate-900/50 rounded-lg border border-slate-700 overflow-hidden" id="neural-viz">
                <!-- SVG Neural Network Visualization -->
                <svg width="100%" height="100%" viewBox="0 0 800 400">
                    <!-- Input Layer -->
                    <g id="layer-input"></g>
                    <!-- Hidden Layer 1 -->
                    <g id="layer-hidden1"></g>
                    <!-- Hidden Layer 2 -->
                    <g id="layer-hidden2"></g>
                    <!-- Output Layer -->
                    <g id="layer-output"></g>
                    <!-- Connections -->
                    <g id="connections"></g>
                </svg>
                
                <div class="absolute bottom-4 left-4 text-xs text-slate-400">
                    <div>Input: 50 features</div>
                    <div>Hidden: 128 ‚Üí 64 neurons</div>
                    <div>Output: 7 actions</div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="glass rounded-xl p-5 border border-slate-700/50">
                <h3 class="font-bold text-cyan-400 mb-3">Weight Distribution</h3>
                <canvas id="weightChart" height="150"></canvas>
            </div>
            
            <div class="glass rounded-xl p-5 border border-slate-700/50">
                <h3 class="font-bold text-cyan-400 mb-3">Activation Patterns</h3>
                <div class="space-y-2" id="activation-bars">
                    <div class="flex items-center gap-2"><span class="text-xs w-16">Fold</span><div class="flex-1 h-2 bg-slate-700 rounded"><div class="h-full bg-cyan-500" style="width: 0%"></div></div></div>
                    <div class="flex items-center gap-2"><span class="text-xs w-16">Check</span><div class="flex-1 h-2 bg-slate-700 rounded"><div class="h-full bg-cyan-500" style="width: 0%"></div></div></div>
                    <div class="flex items-center gap-2"><span class="text-xs w-16">Call</span><div class="flex-1 h-2 bg-slate-700 rounded"><div class="h-full bg-cyan-500" style="width: 0%"></div></div></div>
                    <div class="flex items-center gap-2"><span class="text-xs w-16">Raise</span><div class="flex-1 h-2 bg-slate-700 rounded"><div class="h-full bg-cyan-500" style="width: 0%"></div></div></div>
                </div>
            </div>
            
            <div class="glass rounded-xl p-5 border border-slate-700/50">
                <h3 class="font-bold text-cyan-400 mb-3">Q-Value Heatmap</h3>
                <div class="grid grid-cols-7 gap-1 text-center text-xs" id="q-heatmap">
                    <!-- Generated by JS -->
                </div>
            </div>
        </div>
    </div>

</main>

<!-- Modal for Stat Details -->
<div id="stat-modal" class="modal">
    <div class="glass rounded-2xl p-6 border border-slate-600 max-w-md w-full mx-4">
        <h3 class="text-xl font-bold mb-4" id="modal-title">Statistics</h3>
        <div id="modal-content" class="text-sm text-slate-300 space-y-2"></div>
        <button onclick="closeModal()" class="mt-6 w-full py-2 bg-slate-700 hover:bg-slate-600 rounded-lg font-bold">Close</button>
    </div>
</div>

<script>
// ==================== COMPLETE POKER BOT SYSTEM WITH FULL INTERACTIVITY ====================

// Global State
let autoPlayEnabled = false;
let speedMode = false;
let currentSession = 'game';
let cfrTrainingActive = false;
let dqnTrainingActive = false;

// Card System
class Card {
    constructor(suit, rank) {
        this.suit = suit; // 0-3: C, D, H, S
        this.rank = rank; // 0-12: 2-A
        this.id = suit * 13 + rank;
    }
    
    toString() {
        const suits = ['‚ô£', '‚ô¶', '‚ô•', '‚ô†'];
        const ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
        return { suit: suits[this.suit], rank: ranks[this.rank], color: this.suit % 2 === 0 ? 'black' : 'red' };
    }
    
    static fromId(id) {
        return new Card(Math.floor(id / 13), id % 13);
    }
}

class Deck {
    constructor() {
        this.cards = [];
        for (let s = 0; s < 4; s++) {
            for (let r = 0; r < 13; r++) {
                this.cards.push(new Card(s, r));
            }
        }
        this.shuffle();
    }
    
    shuffle() {
        for (let i = this.cards.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [this.cards[i], this.cards[j]] = [this.cards[j], this.cards[i]];
        }
    }
    
    draw() {
        return this.cards.pop();
    }
}

// Hand Evaluator
class HandEvaluator {
    calculateEquity(hole, community, opponents = 1, iterations = 500) {
        let wins = 0;
        const deck = new Deck();
        const used = [...hole, ...community].map(c => c.id);
        deck.cards = deck.cards.filter(c => !used.includes(c.id));
        
        for (let i = 0; i < iterations; i++) {
            const testDeck = new Deck();
            testDeck.cards = [...deck.cards].sort(() => Math.random() - 0.5);
            
            const oppHoles = [];
            for (let o = 0; o < opponents; o++) {
                oppHoles.push([testDeck.draw(), testDeck.draw()]);
            }
            
            let testCommunity = [...community];
            while (testCommunity.length < 5) {
                testCommunity.push(testDeck.draw());
            }
            
            const myStrength = this.evaluateHand([...hole, ...testCommunity]);
            let bestOpp = -1;
            
            for (const oppHole of oppHoles) {
                const oppStrength = this.evaluateHand([...oppHole, ...testCommunity]);
                if (oppStrength > bestOpp) bestOpp = oppStrength;
            }
            
            if (myStrength > bestOpp) wins++;
        }
        
        return wins / iterations;
    }
    
    evaluateHand(cards) {
        // Simplified: return random for demo (implement proper evaluator in production)
        return Math.random();
    }
}

// CFR Node
class CFRNode {
    constructor(numActions = 7) {
        this.regretSum = new Array(numActions).fill(0);
        this.strategySum = new Array(numActions).fill(0);
        this.numActions = numActions;
    }
    
    getStrategy(realizationWeight) {
        const strategy = this.regretSum.map(r => Math.max(r, 0));
        const normalizingSum = strategy.reduce((a, b) => a + b, 0);
        
        if (normalizingSum > 0) {
            for (let i = 0; i < this.numActions; i++) strategy[i] /= normalizingSum;
        } else {
            for (let i = 0; i < this.numActions; i++) strategy[i] = 1.0 / this.numActions;
        }
        
        for (let i = 0; i < this.numActions; i++) {
            this.strategySum[i] += realizationWeight * strategy[i];
        }
        
        return strategy;
    }
    
    getAverageStrategy() {
        const normalizingSum = this.strategySum.reduce((a, b) => a + b, 0);
        if (normalizingSum > 0) {
            return this.strategySum.map(s => s / normalizingSum);
        }
        return new Array(this.numActions).fill(1.0 / this.numActions);
    }
}

// DQN
class DQN {
    constructor(stateSize = 50, actionSize = 7) {
        this.stateSize = stateSize;
        this.actionSize = actionSize;
        this.memory = [];
        this.gamma = 0.95;
        this.epsilon = 1.0;
        this.epsilonMin = 0.01;
        this.epsilonDecay = 0.995;
        this.learningRate = 0.001;
        this.model = null;
        this.targetModel = null;
        this.initModel();
    }
    
    async initModel() {
        this.model = tf.sequential({
            layers: [
                tf.layers.dense({ inputShape: [this.stateSize], units: 128, activation: 'relu' }),
                tf.layers.dropout({ rate: 0.2 }),
                tf.layers.dense({ units: 64, activation: 'relu' }),
                tf.layers.dropout({ rate: 0.2 }),
                tf.layers.dense({ units: this.actionSize, activation: 'linear' })
            ]
        });
        
        this.model.compile({
            optimizer: tf.train.adam(this.learningRate),
            loss: 'meanSquaredError'
        });
        
        this.targetModel = tf.sequential({
            layers: [
                tf.layers.dense({ inputShape: [this.stateSize], units: 128, activation: 'relu' }),
                tf.layers.dropout({ rate: 0.2 }),
                tf.layers.dense({ units: 64, activation: 'relu' }),
                tf.layers.dropout({ rate: 0.2 }),
                tf.layers.dense({ units: this.actionSize, activation: 'linear' })
            ]
        });
        
        this.targetModel.compile({
            optimizer: tf.train.adam(this.learningRate),
            loss: 'meanSquaredError'
        });
    }
    
    remember(state, action, reward, nextState, done) {
        this.memory.push({ state, action, reward, nextState, done });
        if (this.memory.length > 10000) this.memory.shift();
    }
    
    async act(state, validActions) {
        if (Math.random() <= this.epsilon || !this.model) {
            return validActions[Math.floor(Math.random() * validActions.length)];
        }
        
        const stateTensor = tf.tensor2d([state]);
        const qValues = await this.model.predict(stateTensor).data();
        stateTensor.dispose();
        
        const masked = new Array(this.actionSize).fill(-Infinity);
        validActions.forEach(a => masked[a] = qValues[a]);
        
        return masked.indexOf(Math.max(...masked));
    }
    
    async replay(batchSize = 32) {
        if (this.memory.length < batchSize || !this.model) return null;
        
        const batch = [];
        for (let i = 0; i < batchSize; i++) {
            batch.push(this.memory[Math.floor(Math.random() * this.memory.length)]);
        }
        
        const states = batch.map(e => e.state);
        const nextStates = batch.map(e => e.nextState);
        
        const statesTensor = tf.tensor2d(states);
        const nextStatesTensor = tf.tensor2d(nextStates);
        
        const currentQ = await this.model.predict(statesTensor);
        const nextQ = await this.targetModel.predict(nextStatesTensor);
        
        const currentQData = await currentQ.data();
        const nextQData = await nextQ.data();
        
        const targets = [];
        for (let i = 0; i < batchSize; i++) {
            const target = [...currentQData.slice(i * this.actionSize, (i + 1) * this.actionSize)];
            if (batch[i].done) {
                target[batch[i].action] = batch[i].reward;
            } else {
                const maxNext = Math.max(...nextQData.slice(i * this.actionSize, (i + 1) * this.actionSize));
                target[batch[i].action] = batch[i].reward + this.gamma * maxNext;
            }
            targets.push(target);
        }
        
        const targetsTensor = tf.tensor2d(targets);
        const history = await this.model.fit(statesTensor, targetsTensor, { epochs: 1, verbose: 0 });
        
        statesTensor.dispose();
        nextStatesTensor.dispose();
        currentQ.dispose();
        nextQ.dispose();
        targetsTensor.dispose();
        
        if (this.epsilon > this.epsilonMin) {
            this.epsilon *= this.epsilonDecay;
        }
        
        return history.history.loss[0];
    }
    
    updateTargetModel() {
        if (!this.model || !this.targetModel) return;
        const weights = this.model.getWeights();
        this.targetModel.setWeights(weights);
    }
}

// Opponent Model
class OpponentModel {
    constructor(id) {
        this.id = id;
        this.handsPlayed = 0;
        this.vpip = 0;
        this.pfr = 0;
        this.af = 0;
        this.threeBet = 0;
        this.foldTo3Bet = 0;
        this.cbet = 0;
        this.wtsd = 0;
        this.wsd = 0;
        this.actions = [];
        this.classification = 'Unknown';
    }
    
    update(action, street, amount, pot) {
        this.handsPlayed++;
        
        if (street === 0) {
            if (action !== 'fold') {
                this.vpip = ((this.vpip * (this.handsPlayed - 1)) + 1) / this.handsPlayed;
                if (action === 'raise' || action === 'allin') {
                    this.pfr = ((this.pfr * (this.handsPlayed - 1)) + 1) / this.handsPlayed;
                }
            }
        }
        
        this.actions.push({ action, street, amount, pot, time: Date.now() });
        this.classify();
    }
    
    classify() {
        if (this.handsPlayed < 5) {
            this.classification = 'Unknown';
            return;
        }
        
        if (this.vpip > 0.4 && this.pfr > 0.25) this.classification = 'LAG';
        else if (this.vpip < 0.2 && this.pfr > 0.15) this.classification =
